<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Formulario de Pedido - Papelería</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f0f0f0;
      padding: 20px;
    }
    form {
      background-color: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      max-width: 700px;
      margin: 0 auto;
    }
    label, select, input, textarea {
      display: block;
      width: 100%;
      margin-bottom: 12px;
    }
    .articulo {
      border: 1px solid #ccc;
      border-radius: 10px;
      padding: 10px;
      margin-bottom: 10px;
      background-color: #f9f9f9;
    }
    .articulo label {
      display: inline-block;
      width: auto;
    }
    .cantidad, .observaciones {
      width: 30%;
      display: inline-block;
      margin-left: 10px;
    }
    .boton {
      background-color: #4CAF50;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .boton:hover {
      transform: scale(1.05);
    }
    .fila {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .check {
      margin-left: 10px;
    }
  </style>
</head>
<body>
  <form id="pedidoForm">
    <h2>Formulario de Pedido - Papelería</h2>

    <label for="fecha">Fecha:</label>
    <input type="date" id="fecha" name="fecha" readonly />

    <label for="empresa">Empresa:</label>
    <select id="empresa" name="empresa" required>
      <option value="">Seleccione una empresa</option>
      <option value="BRIASOL">BRIASOL</option>
      <option value="DORALINE">DORALINE</option>
    </select>

    <label for="sector">Sector:</label>
    <select id="sector" name="sector" required>
      <option value="">Seleccione un sector</option>
      <option>Mercado Libre</option>
      <option>Vehículos</option>
      <option>Integra</option>
      <option>Aduana</option>
      <option>Mezzanine</option>
      <option>Recursos Humanos</option>
      <option>Departamento informático</option>
      <option>Administración</option>
      <option>Mantenimiento</option>
    </select>

    <h3>Artículos</h3>
    <div id="articulos">
      <!-- Los artículos se generan con JS -->
    </div>

    <button type="submit" class="boton">Enviar Pedido</button>
  </form>

  <script>
    const articulos = [
      "Bibliorato angosto", "Bibliorato ancho", "Bolígrafo BIC (caja) azul",
      "Bolígrafo BIC (caja) negro", "Bolígrafo BIC (caja) rojo", "Calculadora",
      "Carpeta con elástico", "Cinta adhesiva ancha 48 mm", "Clips 50 mm",
      "Depósito de clips", "Engrampadora", "Folios", "Grampas 26/6",
      "Hojas A4 (resma)", "Lapicera Pilot BP1 color azul", "Lapicera Pilot BP1 color negro",
      "Lapicera Pilot BP1 color rojo", "Libreta con espiral tamaño 108mm x 169mm",
      "Marcador fluorescente amarillo", "Marcador fluorescente fucsia",
      "Marcador fluorescente naranja", "Marcador fluorescente verde",
      "Marcador permanente negro", "Marcador permanente negro punta ancha",
      "Perforadora", "Portalápices", "Portaminas", "Postick 76x76", "Regla",
      "Repuesto portaminas", "Sacagrampas", "Sobres Manila tamaño A4",
      "Sobres Manila tamaño Oficio", "Tijera grande"
    ];

    const contenedor = document.getElementById("articulos");
    articulos.forEach(nombre => {
      const div = document.createElement("div");
      div.className = "articulo";
      div.innerHTML = `
        <div class="fila">
          <label>${nombre}</label>
          <input type="number" placeholder="Cantidad" class="cantidad" min="1" />
          <input type="text" placeholder="Observaciones" class="observaciones" />
        </div>
      `;
      contenedor.appendChild(div);
    });

    document.getElementById("fecha").value = new Date().toISOString().split("T")[0];

    document.getElementById("pedidoForm").addEventListener("submit", function (e) {
      e.preventDefault();

      const fecha = document.getElementById("fecha").value;
      const empresa = document.getElementById("empresa").value;
      const sector = document.getElementById("sector").value;

      const pedidos = [];

      document.querySelectorAll(".articulo").forEach(div => {
        const cantidad = div.querySelector(".cantidad").value;
        const observaciones = div.querySelector(".observaciones").value;

        if (cantidad) {
          pedidos.push({
            fecha,
            empresa,
            sector,
            articulo: div.querySelector("label").textContent,
            cantidad,
            observaciones
          });
        }
      });

      if (pedidos.length === 0) {
        alert("Debe seleccionar al menos un artículo con cantidad.");
        return;
      }

      fetch("https://script.google.com/macros/s/AKfycbyedGgDC4hbwUSs3RaoVG-6vA0hOKtJGx5IePycMZE4x57liiPpIUfVL2Zww_mY0Kbprg/exec", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ pedidos })
      })
      .then(() => {
        alert("Pedido enviado correctamente.");
        document.getElementById("pedidoForm").reset();
        document.getElementById("fecha").value = new Date().toISOString().split("T")[0];
      })
      .catch(error => {
        console.error("Error al enviar:", error);
        alert("Error al enviar el pedido.");
      });
    });
  </script>
</body>
</html>

