<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pedido de Papelería</title>
  <style>
    body {
      background-color: #f0f0f0;
      font-family: sans-serif;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    form {
      background-color: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      max-width: 900px;
      margin: auto;
    }
    label {
      font-weight: bold;
    }
    .articulo {
      display: flex;
      gap: 10px;
      align-items: center;
      margin-bottom: 8px;
    }
    .articulo input[type="number"],
    .articulo input[type="text"] {
      width: 100px;
    }
    button {
      margin-top: 20px;
      background-color: green;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      transform: scale(1.05);
    }
  </style>
</head>
<body>

<h1>Formulario de Pedido de Papelería</h1>

<form id="papeleriaForm">
  <label for="fecha">Fecha:</label>
  <input type="date" id="fecha" name="fecha" readonly /><br><br>

  <label for="empresa">Empresa:</label>
  <select id="empresa" name="empresa">
    <option value="BRIASOL">BRIASOL</option>
    <option value="DORALINE">DORALINE</option>
  </select><br><br>

  <label for="sector">Sector:</label>
  <select id="sector" name="sector">
    <option value="Mercado Libre">Mercado Libre</option>
    <option value="Vehículos">Vehículos</option>
    <option value="Integra">Integra</option>
    <option value="Aduana">Aduana</option>
    <option value="Mezzanine">Mezzanine</option>
    <option value="Recursos Humanos">Recursos Humanos</option>
    <option value="Departamento informático">Departamento informático</option>
    <option value="Administración">Administración</option>
    <option value="Mantenimiento">Mantenimiento</option>
  </select><br><br>

  <div id="listaArticulos">
    <!-- Lista completa de artículos -->
    <div class="articulo"><label>Bibliorato angosto</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Bibliorato ancho</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Bolígrafo BIC (caja) azul</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Bolígrafo BIC (caja) negro</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Bolígrafo BIC (caja) rojo</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Calculadora</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Carpeta con elástico</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Cinta adhesiva ancha 48 mm</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Clips 50 mm</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Depósito de clips</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Engrampadora</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Folios</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Grampas 26/6</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Hojas A4 (resma)</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Lapicera Pilot BP1 color azul</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Lapicera Pilot BP1 color negro</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Lapicera Pilot BP1 color rojo</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Libreta con espiral tamaño 108mm x 169mm</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Marcador fluorescente amarillo</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Marcador fluorescente fucsia</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Marcador fluorescente naranja</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Marcador fluorescente verde</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Marcador permanente negro</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Marcador permanente negro punta ancha</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Perforadora</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Portalápices</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Portaminas</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Postick 76x76</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Regla</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Repuesto portaminas</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Sacagrampas</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Sobres Manila tamaño A4</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Sobres Manila tamaño Oficio</label><input type="number"/><input type="text"/></div>
    <div class="articulo"><label>Tijera grande</label><input type="number"/><input type="text"/></div>
  </div>

  <button type="submit">Enviar Pedido</button>
</form>

<script>
  document.getElementById('fecha').value = new Date().toISOString().split('T')[0];

  document.getElementById('papeleriaForm').addEventListener('submit', function(event) {
    event.preventDefault();

    const fecha = document.getElementById('fecha').value;
    const empresa = document.getElementById('empresa').value;
    const sector = document.getElementById('sector').value;

    const articulos = document.querySelectorAll('.articulo');
    const pedidos = [];

    articulos.forEach(div => {
      const label = div.querySelector('label').textContent.trim();
      const cantidad = div.querySelector('input[type="number"]').value;
      const observaciones = div.querySelector('input[type="text"]').value;

      if (cantidad || observaciones) {
        pedidos.push({
          fecha,
          empresa,
          sector,
          articulo: label,
          cantidad,
          observaciones
        });
      }
    });

    fetch('https://script.google.com/macros/s/AKfycbyedGgDC4hbwUSs3RaoVG-6vA0hOKtJGx5IePycMZE4x57liiPpIUfVL2Zww_mY0Kbprg/exec', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ pedidos })
    })
    .then(response => response.text())
    .then(result => {
      alert('Pedido enviado correctamente.');
      document.getElementById('papeleriaForm').reset();
      document.getElementById('fecha').value = new Date().toISOString().split('T')[0];
    })
    .catch(error => {
      console.error('Error al enviar:', error);
      alert('Hubo un error al enviar el pedido.');
    });
  });
</script>

</body>
</html>
